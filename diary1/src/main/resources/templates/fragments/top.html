<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:fragment="top">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <div class="input-group">
                <button type="button" id="sidebarCollapse" class="btn btn-primary" style="margin-right: 15px">
                    <i class="fa fa-bars"></i> <span class="sr-only">Toggle Menu</span>
                </button>
                <input id="searchInput" type="text" class="form-control bg-light border-0 small"
                    placeholder="Group Search.." aria-label="Search" aria-describedby="basic-addon2">
                <div class="input-group-append">
                    <button id="searchBtn" class="btn btn-primary" type="button">
                        <i class="bi bi-search"></i> ê²€ìƒ‰
                    </button>
                </div>
            </div>
        </div>
    </nav>
    <div id="searchResult" class="mt-3"></div>

    <script>
	    document.getElementById("searchBtn").addEventListener("click", function () {
	        const keyword = document.getElementById("searchInput").value.trim();
	        const searchType = "group";  // ê·¸ë£¹ë§Œ ê²€ìƒ‰í•˜ë„ë¡ ê³ ì •
	        
	        if (!keyword) {
	            alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
	            return;
	        }

	        console.log("ê²€ìƒ‰ì–´:", keyword);  // ê²€ìƒ‰ì–´ í™•ì¸

	        fetch(`/search/${searchType}/${encodeURIComponent(keyword)}`)  // URLì— ê²€ìƒ‰ ìœ í˜• ì¶”ê°€
	            .then(response => {
	                console.log("ì‘ë‹µ ìƒíƒœ:", response);
	                if (!response.ok) {
	                    throw new Error("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜");
	                }
	                return response.json();  // ì‘ë‹µì„ JSONìœ¼ë¡œ ë³€í™˜
	            })
	            .then(data => {
	                console.log("ì„œë²„ ì‘ë‹µ ë°ì´í„°:", data);  // ì„œë²„ ì‘ë‹µ ë°ì´í„° í™•ì¸
	                const resultDiv = document.getElementById("searchResult");

	                if (data.status === "success") {
	                    let html = "<h5>ğŸ” ê²€ìƒ‰ ê²°ê³¼</h5><ul>";

	                    if (data.groups) {
	                        // groupsê°€ ìˆì„ ë•Œ
	                        html += `
	                            <li>
	                                <strong>ê·¸ë£¹ ì´ë¦„:</strong> ${data.groups.group_title} <br>
	                                <strong>ë°°ì§€:</strong> ${data.groups.badge_title}
	                            </li>
	                        `;
	                    } else {
	                        html += "<li>ğŸ”¹ í•´ë‹¹í•˜ëŠ” ê·¸ë£¹ì´ ì—†ìŠµë‹ˆë‹¤.</li>";
	                    }

	                    html += "</ul>";
	                    resultDiv.innerHTML = html;

	                } else {
	                    resultDiv.innerHTML = "<p class='text-danger'>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
	                }
	            })
	            .catch(error => {
	                console.error("ì—ëŸ¬ ë°œìƒ:", error);
	                document.getElementById("searchResult").innerHTML =
	                    "<p class='text-danger'>ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>";
	            });
	    });
    </script>
</th:block>
</html>